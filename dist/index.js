var It=Object.defineProperty;var Pt=(e,t,i)=>t in e?It(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var et=(e,t,i)=>(Pt(e,typeof t!="symbol"?t+"":t,i),i);const Ct=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const h of n.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function i(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerpolicy&&(n.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?n.credentials="include":r.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(r){if(r.ep)return;r.ep=!0;const n=i(r);fetch(r.href,n)}};Ct();class Z{constructor(){this.callbacks={},this.callbacks.base={}}on(t,i){return typeof t=="undefined"||t===""?(console.warn("wrong names"),!1):typeof i=="undefined"?(console.warn("wrong callback"),!1):(this.resolveNames(t).forEach(r=>{const n=this.resolveName(r);this.callbacks[n.namespace]instanceof Object||(this.callbacks[n.namespace]={}),this.callbacks[n.namespace][n.value]instanceof Array||(this.callbacks[n.namespace][n.value]=[]),this.callbacks[n.namespace][n.value].push(i)}),this)}off(t){return typeof t=="undefined"||t===""?(console.warn("wrong name"),!1):(this.resolveNames(t).forEach(s=>{const r=this.resolveName(s);if(r.namespace!=="base"&&r.value==="")delete this.callbacks[r.namespace];else if(r.namespace==="base")for(const n in this.callbacks)this.callbacks[n]instanceof Object&&this.callbacks[n][r.value]instanceof Array&&(delete this.callbacks[n][r.value],Object.keys(this.callbacks[n]).length===0&&delete this.callbacks[n]);else this.callbacks[r.namespace]instanceof Object&&this.callbacks[r.namespace][r.value]instanceof Array&&(delete this.callbacks[r.namespace][r.value],Object.keys(this.callbacks[r.namespace]).length===0&&delete this.callbacks[r.namespace])}),this)}trigger(t,i){if(typeof t=="undefined"||t==="")return console.warn("wrong name"),!1;let s=null;const r=i instanceof Array?i:[];let n=this.resolveNames(t);if(n=this.resolveName(n[0]),n.namespace==="base")for(const h in this.callbacks)this.callbacks[h]instanceof Object&&this.callbacks[h][n.value]instanceof Array&&this.callbacks[h][n.value].forEach(function(a){a.apply(this,r)});else if(this.callbacks[n.namespace]instanceof Object){if(n.value==="")return console.warn("wrong name"),this;this.callbacks[n.namespace][n.value].forEach(function(h){h.apply(this,r)})}return s}resolveNames(t){let i=t;return i=i.replace(/[^a-zA-Z0-9 ,/.]/g,""),i=i.replace(/[,/]+/g," "),i=i.split(" "),i}resolveName(t){const i={},s=t.split(".");return i.original=t,i.value=s[0],i.namespace="base",s.length>1&&s[1]!==""&&(i.namespace=s[1]),i}}class Ot extends Z{constructor(){super(),this.start=Date.now(),this.current=this.start,this.elapsed=0,this.delta=16,window.requestAnimationFrame(()=>{this.tick()})}tick(){const t=Date.now();this.delta=t-this.current,this.current=t,this.elapsed=this.current-this.start,this.trigger("tick"),window.requestAnimationFrame(()=>{this.tick()})}}class Nt extends Z{constructor(){super(),this.updateSizes(),window.addEventListener("resize",()=>{this.updateSizes(),this.trigger("resize")})}updateSizes(){this.width=window.innerWidth,this.height=window.innerHeight,this.pixelRatio=Math.min(window.devicePixelRatio,2)}}function it(e){let t=e[0],i=e[1],s=e[2];return Math.sqrt(t*t+i*i+s*s)}function j(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function qt(e,t,i,s){return e[0]=t,e[1]=i,e[2]=s,e}function st(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e}function rt(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e}function Bt(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e}function Dt(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e}function k(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e}function Ut(e,t){let i=t[0]-e[0],s=t[1]-e[1],r=t[2]-e[2];return Math.sqrt(i*i+s*s+r*r)}function kt(e,t){let i=t[0]-e[0],s=t[1]-e[1],r=t[2]-e[2];return i*i+s*s+r*r}function nt(e){let t=e[0],i=e[1],s=e[2];return t*t+i*i+s*s}function Vt(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function $t(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function W(e,t){let i=t[0],s=t[1],r=t[2],n=i*i+s*s+r*r;return n>0&&(n=1/Math.sqrt(n)),e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function Ft(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function ht(e,t,i){let s=t[0],r=t[1],n=t[2],h=i[0],a=i[1],l=i[2];return e[0]=r*l-n*a,e[1]=n*h-s*l,e[2]=s*a-r*h,e}function Xt(e,t,i,s){let r=t[0],n=t[1],h=t[2];return e[0]=r+s*(i[0]-r),e[1]=n+s*(i[1]-n),e[2]=h+s*(i[2]-h),e}function Yt(e,t,i){let s=t[0],r=t[1],n=t[2],h=i[3]*s+i[7]*r+i[11]*n+i[15];return h=h||1,e[0]=(i[0]*s+i[4]*r+i[8]*n+i[12])/h,e[1]=(i[1]*s+i[5]*r+i[9]*n+i[13])/h,e[2]=(i[2]*s+i[6]*r+i[10]*n+i[14])/h,e}function Gt(e,t,i){let s=t[0],r=t[1],n=t[2],h=i[3]*s+i[7]*r+i[11]*n+i[15];return h=h||1,e[0]=(i[0]*s+i[4]*r+i[8]*n)/h,e[1]=(i[1]*s+i[5]*r+i[9]*n)/h,e[2]=(i[2]*s+i[6]*r+i[10]*n)/h,e}function jt(e,t,i){let s=t[0],r=t[1],n=t[2];return e[0]=s*i[0]+r*i[3]+n*i[6],e[1]=s*i[1]+r*i[4]+n*i[7],e[2]=s*i[2]+r*i[5]+n*i[8],e}function Wt(e,t,i){let s=t[0],r=t[1],n=t[2],h=i[0],a=i[1],l=i[2],c=i[3],o=a*n-l*r,d=l*s-h*n,u=h*r-a*s,f=a*u-l*d,p=l*o-h*u,m=h*d-a*o,g=c*2;return o*=g,d*=g,u*=g,f*=2,p*=2,m*=2,e[0]=s+o+f,e[1]=r+d+p,e[2]=n+u+m,e}const Zt=function(){const e=[0,0,0],t=[0,0,0];return function(i,s){j(e,i),j(t,s),W(e,e),W(t,t);let r=Ft(e,t);return r>1?0:r<-1?Math.PI:Math.acos(r)}}();function Ht(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}class A extends Array{constructor(t=0,i=t,s=t){return super(t,i,s),this}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(t){this[0]=t}set y(t){this[1]=t}set z(t){this[2]=t}set(t,i=t,s=t){return t.length?this.copy(t):(qt(this,t,i,s),this)}copy(t){return j(this,t),this}add(t,i){return i?st(this,t,i):st(this,this,t),this}sub(t,i){return i?rt(this,t,i):rt(this,this,t),this}multiply(t){return t.length?Bt(this,this,t):k(this,this,t),this}divide(t){return t.length?Dt(this,this,t):k(this,this,1/t),this}inverse(t=this){return $t(this,t),this}len(){return it(this)}distance(t){return t?Ut(this,t):it(this)}squaredLen(){return nt(this)}squaredDistance(t){return t?kt(this,t):nt(this)}negate(t=this){return Vt(this,t),this}cross(t,i){return i?ht(this,t,i):ht(this,this,t),this}scale(t){return k(this,this,t),this}normalize(){return W(this,this),this}dot(t){return Ft(this,t)}equals(t){return Ht(this,t)}applyMatrix3(t){return jt(this,this,t),this}applyMatrix4(t){return Yt(this,this,t),this}scaleRotateMatrix4(t){return Gt(this,this,t),this}applyQuaternion(t){return Wt(this,this,t),this}angle(t){return Zt(this,t)}lerp(t,i){return Xt(this,this,t,i),this}clone(){return new A(this[0],this[1],this[2])}fromArray(t,i=0){return this[0]=t[i],this[1]=t[i+1],this[2]=t[i+2],this}toArray(t=[],i=0){return t[i]=this[0],t[i+1]=this[1],t[i+2]=this[2],t}transformDirection(t){const i=this[0],s=this[1],r=this[2];return this[0]=t[0]*i+t[4]*s+t[8]*r,this[1]=t[1]*i+t[5]*s+t[9]*r,this[2]=t[2]*i+t[6]*s+t[10]*r,this.normalize()}}const at=new A;let Qt=1,Kt=1,lt=!1;class Jt{constructor(t,i={}){t.canvas||console.error("gl not passed as first argument to Geometry"),this.gl=t,this.attributes=i,this.id=Qt++,this.VAOs={},this.drawRange={start:0,count:0},this.instancedCount=0,this.gl.renderer.bindVertexArray(null),this.gl.renderer.currentGeometry=null,this.glState=this.gl.renderer.state;for(let s in i)this.addAttribute(s,i[s])}addAttribute(t,i){if(this.attributes[t]=i,i.id=Kt++,i.size=i.size||1,i.type=i.type||(i.data.constructor===Float32Array?this.gl.FLOAT:i.data.constructor===Uint16Array?this.gl.UNSIGNED_SHORT:this.gl.UNSIGNED_INT),i.target=t==="index"?this.gl.ELEMENT_ARRAY_BUFFER:this.gl.ARRAY_BUFFER,i.normalized=i.normalized||!1,i.stride=i.stride||0,i.offset=i.offset||0,i.count=i.count||(i.stride?i.data.byteLength/i.stride:i.data.length/i.size),i.divisor=i.instanced||0,i.needsUpdate=!1,i.usage=i.usage||this.gl.STATIC_DRAW,i.buffer||this.updateAttribute(i),i.divisor){if(this.isInstanced=!0,this.instancedCount&&this.instancedCount!==i.count*i.divisor)return console.warn("geometry has multiple instanced buffers of different length"),this.instancedCount=Math.min(this.instancedCount,i.count*i.divisor);this.instancedCount=i.count*i.divisor}else t==="index"?this.drawRange.count=i.count:this.attributes.index||(this.drawRange.count=Math.max(this.drawRange.count,i.count))}updateAttribute(t){const i=!t.buffer;i&&(t.buffer=this.gl.createBuffer()),this.glState.boundBuffer!==t.buffer&&(this.gl.bindBuffer(t.target,t.buffer),this.glState.boundBuffer=t.buffer),i?this.gl.bufferData(t.target,t.data,t.usage):this.gl.bufferSubData(t.target,0,t.data),t.needsUpdate=!1}setIndex(t){this.addAttribute("index",t)}setDrawRange(t,i){this.drawRange.start=t,this.drawRange.count=i}setInstancedCount(t){this.instancedCount=t}createVAO(t){this.VAOs[t.attributeOrder]=this.gl.renderer.createVertexArray(),this.gl.renderer.bindVertexArray(this.VAOs[t.attributeOrder]),this.bindAttributes(t)}bindAttributes(t){t.attributeLocations.forEach((i,{name:s,type:r})=>{if(!this.attributes[s]){console.warn(`active attribute ${s} not being supplied`);return}const n=this.attributes[s];this.gl.bindBuffer(n.target,n.buffer),this.glState.boundBuffer=n.buffer;let h=1;r===35674&&(h=2),r===35675&&(h=3),r===35676&&(h=4);const a=n.size/h,l=h===1?0:h*h*h,c=h===1?0:h*h;for(let o=0;o<h;o++)this.gl.vertexAttribPointer(i+o,a,n.type,n.normalized,n.stride+l,n.offset+o*c),this.gl.enableVertexAttribArray(i+o),this.gl.renderer.vertexAttribDivisor(i+o,n.divisor)}),this.attributes.index&&this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.attributes.index.buffer)}draw({program:t,mode:i=this.gl.TRIANGLES}){this.gl.renderer.currentGeometry!==`${this.id}_${t.attributeOrder}`&&(this.VAOs[t.attributeOrder]||this.createVAO(t),this.gl.renderer.bindVertexArray(this.VAOs[t.attributeOrder]),this.gl.renderer.currentGeometry=`${this.id}_${t.attributeOrder}`),t.attributeLocations.forEach((s,{name:r})=>{const n=this.attributes[r];n.needsUpdate&&this.updateAttribute(n)}),this.isInstanced?this.attributes.index?this.gl.renderer.drawElementsInstanced(i,this.drawRange.count,this.attributes.index.type,this.attributes.index.offset+this.drawRange.start*2,this.instancedCount):this.gl.renderer.drawArraysInstanced(i,this.drawRange.start,this.drawRange.count,this.instancedCount):this.attributes.index?this.gl.drawElements(i,this.drawRange.count,this.attributes.index.type,this.attributes.index.offset+this.drawRange.start*2):this.gl.drawArrays(i,this.drawRange.start,this.drawRange.count)}getPosition(){const t=this.attributes.position;if(t.data)return t;if(!lt)return console.warn("No position buffer data found to compute bounds"),lt=!0}computeBoundingBox(t){t||(t=this.getPosition());const i=t.data,s=t.stride?t.stride/i.BYTES_PER_ELEMENT:t.size;this.bounds||(this.bounds={min:new A,max:new A,center:new A,scale:new A,radius:1/0});const r=this.bounds.min,n=this.bounds.max,h=this.bounds.center,a=this.bounds.scale;r.set(1/0),n.set(-1/0);for(let l=0,c=i.length;l<c;l+=s){const o=i[l],d=i[l+1],u=i[l+2];r.x=Math.min(o,r.x),r.y=Math.min(d,r.y),r.z=Math.min(u,r.z),n.x=Math.max(o,n.x),n.y=Math.max(d,n.y),n.z=Math.max(u,n.z)}a.sub(n,r),h.add(r,n).divide(2)}computeBoundingSphere(t){t||(t=this.getPosition());const i=t.data,s=t.stride?t.stride/i.BYTES_PER_ELEMENT:t.size;this.bounds||this.computeBoundingBox(t);let r=0;for(let n=0,h=i.length;n<h;n+=s)at.fromArray(i,n),r=Math.max(r,this.bounds.center.squaredDistance(at));this.bounds.radius=Math.sqrt(r)}remove(){for(let t in this.VAOs)this.gl.renderer.deleteVertexArray(this.VAOs[t]),delete this.VAOs[t];for(let t in this.attributes)this.gl.deleteBuffer(this.attributes[t].buffer),delete this.attributes[t]}}let te=1;const ct={};class ee{constructor(t,{vertex:i,fragment:s,uniforms:r={},transparent:n=!1,cullFace:h=t.BACK,frontFace:a=t.CCW,depthTest:l=!0,depthWrite:c=!0,depthFunc:o=t.LESS}={}){t.canvas||console.error("gl not passed as first argument to Program"),this.gl=t,this.uniforms=r,this.id=te++,i||console.warn("vertex shader not supplied"),s||console.warn("fragment shader not supplied"),this.transparent=n,this.cullFace=h,this.frontFace=a,this.depthTest=l,this.depthWrite=c,this.depthFunc=o,this.blendFunc={},this.blendEquation={},this.transparent&&!this.blendFunc.src&&(this.gl.renderer.premultipliedAlpha?this.setBlendFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA):this.setBlendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA));const d=t.createShader(t.VERTEX_SHADER);t.shaderSource(d,i),t.compileShader(d),t.getShaderInfoLog(d)!==""&&console.warn(`${t.getShaderInfoLog(d)}
Vertex Shader
${ot(i)}`);const u=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(u,s),t.compileShader(u),t.getShaderInfoLog(u)!==""&&console.warn(`${t.getShaderInfoLog(u)}
Fragment Shader
${ot(s)}`),this.program=t.createProgram(),t.attachShader(this.program,d),t.attachShader(this.program,u),t.linkProgram(this.program),!t.getProgramParameter(this.program,t.LINK_STATUS))return console.warn(t.getProgramInfoLog(this.program));t.deleteShader(d),t.deleteShader(u),this.uniformLocations=new Map;let f=t.getProgramParameter(this.program,t.ACTIVE_UNIFORMS);for(let g=0;g<f;g++){let x=t.getActiveUniform(this.program,g);this.uniformLocations.set(x,t.getUniformLocation(this.program,x.name));const v=x.name.match(/(\w+)/g);x.uniformName=v[0],v.length===3?(x.isStructArray=!0,x.structIndex=Number(v[1]),x.structProperty=v[2]):v.length===2&&isNaN(Number(v[1]))&&(x.isStruct=!0,x.structProperty=v[1])}this.attributeLocations=new Map;const p=[],m=t.getProgramParameter(this.program,t.ACTIVE_ATTRIBUTES);for(let g=0;g<m;g++){const x=t.getActiveAttrib(this.program,g),v=t.getAttribLocation(this.program,x.name);v!==-1&&(p[v]=x.name,this.attributeLocations.set(x,v))}this.attributeOrder=p.join("")}setBlendFunc(t,i,s,r){this.blendFunc.src=t,this.blendFunc.dst=i,this.blendFunc.srcAlpha=s,this.blendFunc.dstAlpha=r,t&&(this.transparent=!0)}setBlendEquation(t,i){this.blendEquation.modeRGB=t,this.blendEquation.modeAlpha=i}applyState(){this.depthTest?this.gl.renderer.enable(this.gl.DEPTH_TEST):this.gl.renderer.disable(this.gl.DEPTH_TEST),this.cullFace?this.gl.renderer.enable(this.gl.CULL_FACE):this.gl.renderer.disable(this.gl.CULL_FACE),this.blendFunc.src?this.gl.renderer.enable(this.gl.BLEND):this.gl.renderer.disable(this.gl.BLEND),this.cullFace&&this.gl.renderer.setCullFace(this.cullFace),this.gl.renderer.setFrontFace(this.frontFace),this.gl.renderer.setDepthMask(this.depthWrite),this.gl.renderer.setDepthFunc(this.depthFunc),this.blendFunc.src&&this.gl.renderer.setBlendFunc(this.blendFunc.src,this.blendFunc.dst,this.blendFunc.srcAlpha,this.blendFunc.dstAlpha),this.gl.renderer.setBlendEquation(this.blendEquation.modeRGB,this.blendEquation.modeAlpha)}use({flipFaces:t=!1}={}){let i=-1;this.gl.renderer.state.currentProgram===this.id||(this.gl.useProgram(this.program),this.gl.renderer.state.currentProgram=this.id),this.uniformLocations.forEach((r,n)=>{let h=n.uniformName,a=this.uniforms[h];if(n.isStruct&&(a=a[n.structProperty],h+=`.${n.structProperty}`),n.isStructArray&&(a=a[n.structIndex][n.structProperty],h+=`[${n.structIndex}].${n.structProperty}`),!a)return dt(`Active uniform ${h} has not been supplied`);if(a&&a.value===void 0)return dt(`${h} uniform is missing a value parameter`);if(a.value.texture)return i=i+1,a.value.update(i),V(this.gl,n.type,r,i);if(a.value.length&&a.value[0].texture){const l=[];return a.value.forEach(c=>{i=i+1,c.update(i),l.push(i)}),V(this.gl,n.type,r,l)}V(this.gl,n.type,r,a.value)}),this.applyState(),t&&this.gl.renderer.setFrontFace(this.frontFace===this.gl.CCW?this.gl.CW:this.gl.CCW)}remove(){this.gl.deleteProgram(this.program)}}function V(e,t,i,s){s=s.length?ie(s):s;const r=e.renderer.state.uniformLocations.get(i);if(s.length)if(r===void 0||r.length!==s.length)e.renderer.state.uniformLocations.set(i,s.slice(0));else{if(se(r,s))return;r.set?r.set(s):re(r,s),e.renderer.state.uniformLocations.set(i,r)}else{if(r===s)return;e.renderer.state.uniformLocations.set(i,s)}switch(t){case 5126:return s.length?e.uniform1fv(i,s):e.uniform1f(i,s);case 35664:return e.uniform2fv(i,s);case 35665:return e.uniform3fv(i,s);case 35666:return e.uniform4fv(i,s);case 35670:case 5124:case 35678:case 35680:return s.length?e.uniform1iv(i,s):e.uniform1i(i,s);case 35671:case 35667:return e.uniform2iv(i,s);case 35672:case 35668:return e.uniform3iv(i,s);case 35673:case 35669:return e.uniform4iv(i,s);case 35674:return e.uniformMatrix2fv(i,!1,s);case 35675:return e.uniformMatrix3fv(i,!1,s);case 35676:return e.uniformMatrix4fv(i,!1,s)}}function ot(e){let t=e.split(`
`);for(let i=0;i<t.length;i++)t[i]=i+1+": "+t[i];return t.join(`
`)}function ie(e){const t=e.length,i=e[0].length;if(i===void 0)return e;const s=t*i;let r=ct[s];r||(ct[s]=r=new Float32Array(s));for(let n=0;n<t;n++)r.set(e[n],n*i);return r}function se(e,t){if(e.length!==t.length)return!1;for(let i=0,s=e.length;i<s;i++)if(e[i]!==t[i])return!1;return!0}function re(e,t){for(let i=0,s=e.length;i<s;i++)e[i]=t[i]}let $=0;function dt(e){$>100||(console.warn(e),$++,$>100&&console.warn("More than 100 program warnings - stopping logs."))}const X=new A;let ne=1;class he{constructor({canvas:t=document.createElement("canvas"),width:i=300,height:s=150,dpr:r=1,alpha:n=!1,depth:h=!0,stencil:a=!1,antialias:l=!1,premultipliedAlpha:c=!1,preserveDrawingBuffer:o=!1,powerPreference:d="default",autoClear:u=!0,webgl:f=2}={}){const p={alpha:n,depth:h,stencil:a,antialias:l,premultipliedAlpha:c,preserveDrawingBuffer:o,powerPreference:d};this.dpr=r,this.alpha=n,this.color=!0,this.depth=h,this.stencil=a,this.premultipliedAlpha=c,this.autoClear=u,this.id=ne++,f===2&&(this.gl=t.getContext("webgl2",p)),this.isWebgl2=!!this.gl,this.gl||(this.gl=t.getContext("webgl",p)),this.gl||console.error("unable to create webgl context"),this.gl.renderer=this,this.setSize(i,s),this.state={},this.state.blendFunc={src:this.gl.ONE,dst:this.gl.ZERO},this.state.blendEquation={modeRGB:this.gl.FUNC_ADD},this.state.cullFace=null,this.state.frontFace=this.gl.CCW,this.state.depthMask=!0,this.state.depthFunc=this.gl.LESS,this.state.premultiplyAlpha=!1,this.state.flipY=!1,this.state.unpackAlignment=4,this.state.framebuffer=null,this.state.viewport={x:0,y:0,width:null,height:null},this.state.textureUnits=[],this.state.activeTextureUnit=0,this.state.boundBuffer=null,this.state.uniformLocations=new Map,this.state.currentProgram=null,this.extensions={},this.isWebgl2?(this.getExtension("EXT_color_buffer_float"),this.getExtension("OES_texture_float_linear")):(this.getExtension("OES_texture_float"),this.getExtension("OES_texture_float_linear"),this.getExtension("OES_texture_half_float"),this.getExtension("OES_texture_half_float_linear"),this.getExtension("OES_element_index_uint"),this.getExtension("OES_standard_derivatives"),this.getExtension("EXT_sRGB"),this.getExtension("WEBGL_depth_texture"),this.getExtension("WEBGL_draw_buffers")),this.getExtension("WEBGL_compressed_texture_astc"),this.getExtension("EXT_texture_compression_bptc"),this.getExtension("WEBGL_compressed_texture_s3tc"),this.getExtension("WEBGL_compressed_texture_etc1"),this.getExtension("WEBGL_compressed_texture_pvrtc"),this.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),this.vertexAttribDivisor=this.getExtension("ANGLE_instanced_arrays","vertexAttribDivisor","vertexAttribDivisorANGLE"),this.drawArraysInstanced=this.getExtension("ANGLE_instanced_arrays","drawArraysInstanced","drawArraysInstancedANGLE"),this.drawElementsInstanced=this.getExtension("ANGLE_instanced_arrays","drawElementsInstanced","drawElementsInstancedANGLE"),this.createVertexArray=this.getExtension("OES_vertex_array_object","createVertexArray","createVertexArrayOES"),this.bindVertexArray=this.getExtension("OES_vertex_array_object","bindVertexArray","bindVertexArrayOES"),this.deleteVertexArray=this.getExtension("OES_vertex_array_object","deleteVertexArray","deleteVertexArrayOES"),this.drawBuffers=this.getExtension("WEBGL_draw_buffers","drawBuffers","drawBuffersWEBGL"),this.parameters={},this.parameters.maxTextureUnits=this.gl.getParameter(this.gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this.parameters.maxAnisotropy=this.getExtension("EXT_texture_filter_anisotropic")?this.gl.getParameter(this.getExtension("EXT_texture_filter_anisotropic").MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}setSize(t,i){this.width=t,this.height=i,this.gl.canvas.width=t*this.dpr,this.gl.canvas.height=i*this.dpr,Object.assign(this.gl.canvas.style,{width:t+"px",height:i+"px"})}setViewport(t,i,s=0,r=0){this.state.viewport.width===t&&this.state.viewport.height===i||(this.state.viewport.width=t,this.state.viewport.height=i,this.state.viewport.x=s,this.state.viewport.y=r,this.gl.viewport(s,r,t,i))}setScissor(t,i,s=0,r=0){this.gl.scissor(s,r,t,i)}enable(t){this.state[t]!==!0&&(this.gl.enable(t),this.state[t]=!0)}disable(t){this.state[t]!==!1&&(this.gl.disable(t),this.state[t]=!1)}setBlendFunc(t,i,s,r){this.state.blendFunc.src===t&&this.state.blendFunc.dst===i&&this.state.blendFunc.srcAlpha===s&&this.state.blendFunc.dstAlpha===r||(this.state.blendFunc.src=t,this.state.blendFunc.dst=i,this.state.blendFunc.srcAlpha=s,this.state.blendFunc.dstAlpha=r,s!==void 0?this.gl.blendFuncSeparate(t,i,s,r):this.gl.blendFunc(t,i))}setBlendEquation(t,i){t=t||this.gl.FUNC_ADD,!(this.state.blendEquation.modeRGB===t&&this.state.blendEquation.modeAlpha===i)&&(this.state.blendEquation.modeRGB=t,this.state.blendEquation.modeAlpha=i,i!==void 0?this.gl.blendEquationSeparate(t,i):this.gl.blendEquation(t))}setCullFace(t){this.state.cullFace!==t&&(this.state.cullFace=t,this.gl.cullFace(t))}setFrontFace(t){this.state.frontFace!==t&&(this.state.frontFace=t,this.gl.frontFace(t))}setDepthMask(t){this.state.depthMask!==t&&(this.state.depthMask=t,this.gl.depthMask(t))}setDepthFunc(t){this.state.depthFunc!==t&&(this.state.depthFunc=t,this.gl.depthFunc(t))}activeTexture(t){this.state.activeTextureUnit!==t&&(this.state.activeTextureUnit=t,this.gl.activeTexture(this.gl.TEXTURE0+t))}bindFramebuffer({target:t=this.gl.FRAMEBUFFER,buffer:i=null}={}){this.state.framebuffer!==i&&(this.state.framebuffer=i,this.gl.bindFramebuffer(t,i))}getExtension(t,i,s){return i&&this.gl[i]?this.gl[i].bind(this.gl):(this.extensions[t]||(this.extensions[t]=this.gl.getExtension(t)),i?this.extensions[t]?this.extensions[t][s].bind(this.extensions[t]):null:this.extensions[t])}sortOpaque(t,i){return t.renderOrder!==i.renderOrder?t.renderOrder-i.renderOrder:t.program.id!==i.program.id?t.program.id-i.program.id:t.zDepth!==i.zDepth?t.zDepth-i.zDepth:i.id-t.id}sortTransparent(t,i){return t.renderOrder!==i.renderOrder?t.renderOrder-i.renderOrder:t.zDepth!==i.zDepth?i.zDepth-t.zDepth:i.id-t.id}sortUI(t,i){return t.renderOrder!==i.renderOrder?t.renderOrder-i.renderOrder:t.program.id!==i.program.id?t.program.id-i.program.id:i.id-t.id}getRenderList({scene:t,camera:i,frustumCull:s,sort:r}){let n=[];if(i&&s&&i.updateFrustum(),t.traverse(h=>{if(!h.visible)return!0;!h.draw||s&&h.frustumCulled&&i&&!i.frustumIntersectsMesh(h)||n.push(h)}),r){const h=[],a=[],l=[];n.forEach(c=>{c.program.transparent?c.program.depthTest?a.push(c):l.push(c):h.push(c),c.zDepth=0,!(c.renderOrder!==0||!c.program.depthTest||!i)&&(c.worldMatrix.getTranslation(X),X.applyMatrix4(i.projectionViewMatrix),c.zDepth=X.z)}),h.sort(this.sortOpaque),a.sort(this.sortTransparent),l.sort(this.sortUI),n=h.concat(a,l)}return n}render({scene:t,camera:i,target:s=null,update:r=!0,sort:n=!0,frustumCull:h=!0,clear:a}){s===null?(this.bindFramebuffer(),this.setViewport(this.width*this.dpr,this.height*this.dpr)):(this.bindFramebuffer(s),this.setViewport(s.width,s.height)),(a||this.autoClear&&a!==!1)&&(this.depth&&(!s||s.depth)&&(this.enable(this.gl.DEPTH_TEST),this.setDepthMask(!0)),this.gl.clear((this.color?this.gl.COLOR_BUFFER_BIT:0)|(this.depth?this.gl.DEPTH_BUFFER_BIT:0)|(this.stencil?this.gl.STENCIL_BUFFER_BIT:0))),r&&t.updateMatrixWorld(),i&&i.updateMatrixWorld(),this.getRenderList({scene:t,camera:i,frustumCull:h,sort:n}).forEach(c=>{c.draw({camera:i})})}}function ae(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function le(e,t,i,s,r){return e[0]=t,e[1]=i,e[2]=s,e[3]=r,e}function ce(e,t){let i=t[0],s=t[1],r=t[2],n=t[3],h=i*i+s*s+r*r+n*n;return h>0&&(h=1/Math.sqrt(h)),e[0]=i*h,e[1]=s*h,e[2]=r*h,e[3]=n*h,e}function oe(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function de(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function ue(e,t,i){i=i*.5;let s=Math.sin(i);return e[0]=s*t[0],e[1]=s*t[1],e[2]=s*t[2],e[3]=Math.cos(i),e}function ut(e,t,i){let s=t[0],r=t[1],n=t[2],h=t[3],a=i[0],l=i[1],c=i[2],o=i[3];return e[0]=s*o+h*a+r*c-n*l,e[1]=r*o+h*l+n*a-s*c,e[2]=n*o+h*c+s*l-r*a,e[3]=h*o-s*a-r*l-n*c,e}function fe(e,t,i){i*=.5;let s=t[0],r=t[1],n=t[2],h=t[3],a=Math.sin(i),l=Math.cos(i);return e[0]=s*l+h*a,e[1]=r*l+n*a,e[2]=n*l-r*a,e[3]=h*l-s*a,e}function pe(e,t,i){i*=.5;let s=t[0],r=t[1],n=t[2],h=t[3],a=Math.sin(i),l=Math.cos(i);return e[0]=s*l-n*a,e[1]=r*l+h*a,e[2]=n*l+s*a,e[3]=h*l-r*a,e}function ge(e,t,i){i*=.5;let s=t[0],r=t[1],n=t[2],h=t[3],a=Math.sin(i),l=Math.cos(i);return e[0]=s*l+r*a,e[1]=r*l-s*a,e[2]=n*l+h*a,e[3]=h*l-n*a,e}function me(e,t,i,s){let r=t[0],n=t[1],h=t[2],a=t[3],l=i[0],c=i[1],o=i[2],d=i[3],u,f,p,m,g;return f=r*l+n*c+h*o+a*d,f<0&&(f=-f,l=-l,c=-c,o=-o,d=-d),1-f>1e-6?(u=Math.acos(f),p=Math.sin(u),m=Math.sin((1-s)*u)/p,g=Math.sin(s*u)/p):(m=1-s,g=s),e[0]=m*r+g*l,e[1]=m*n+g*c,e[2]=m*h+g*o,e[3]=m*a+g*d,e}function xe(e,t){let i=t[0],s=t[1],r=t[2],n=t[3],h=i*i+s*s+r*r+n*n,a=h?1/h:0;return e[0]=-i*a,e[1]=-s*a,e[2]=-r*a,e[3]=n*a,e}function ye(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function we(e,t){let i=t[0]+t[4]+t[8],s;if(i>0)s=Math.sqrt(i+1),e[3]=.5*s,s=.5/s,e[0]=(t[5]-t[7])*s,e[1]=(t[6]-t[2])*s,e[2]=(t[1]-t[3])*s;else{let r=0;t[4]>t[0]&&(r=1),t[8]>t[r*3+r]&&(r=2);let n=(r+1)%3,h=(r+2)%3;s=Math.sqrt(t[r*3+r]-t[n*3+n]-t[h*3+h]+1),e[r]=.5*s,s=.5/s,e[3]=(t[n*3+h]-t[h*3+n])*s,e[n]=(t[n*3+r]+t[r*3+n])*s,e[h]=(t[h*3+r]+t[r*3+h])*s}return e}function Me(e,t,i="YXZ"){let s=Math.sin(t[0]*.5),r=Math.cos(t[0]*.5),n=Math.sin(t[1]*.5),h=Math.cos(t[1]*.5),a=Math.sin(t[2]*.5),l=Math.cos(t[2]*.5);return i==="XYZ"?(e[0]=s*h*l+r*n*a,e[1]=r*n*l-s*h*a,e[2]=r*h*a+s*n*l,e[3]=r*h*l-s*n*a):i==="YXZ"?(e[0]=s*h*l+r*n*a,e[1]=r*n*l-s*h*a,e[2]=r*h*a-s*n*l,e[3]=r*h*l+s*n*a):i==="ZXY"?(e[0]=s*h*l-r*n*a,e[1]=r*n*l+s*h*a,e[2]=r*h*a+s*n*l,e[3]=r*h*l-s*n*a):i==="ZYX"?(e[0]=s*h*l-r*n*a,e[1]=r*n*l+s*h*a,e[2]=r*h*a-s*n*l,e[3]=r*h*l+s*n*a):i==="YZX"?(e[0]=s*h*l+r*n*a,e[1]=r*n*l+s*h*a,e[2]=r*h*a-s*n*l,e[3]=r*h*l-s*n*a):i==="XZY"&&(e[0]=s*h*l-r*n*a,e[1]=r*n*l-s*h*a,e[2]=r*h*a+s*n*l,e[3]=r*h*l+s*n*a),e}const be=ae,Ee=le,ve=oe,Ae=ce;class ze extends Array{constructor(t=0,i=0,s=0,r=1){return super(t,i,s,r),this.onChange=()=>{},this}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}get w(){return this[3]}set x(t){this[0]=t,this.onChange()}set y(t){this[1]=t,this.onChange()}set z(t){this[2]=t,this.onChange()}set w(t){this[3]=t,this.onChange()}identity(){return de(this),this.onChange(),this}set(t,i,s,r){return t.length?this.copy(t):(Ee(this,t,i,s,r),this.onChange(),this)}rotateX(t){return fe(this,this,t),this.onChange(),this}rotateY(t){return pe(this,this,t),this.onChange(),this}rotateZ(t){return ge(this,this,t),this.onChange(),this}inverse(t=this){return xe(this,t),this.onChange(),this}conjugate(t=this){return ye(this,t),this.onChange(),this}copy(t){return be(this,t),this.onChange(),this}normalize(t=this){return Ae(this,t),this.onChange(),this}multiply(t,i){return i?ut(this,t,i):ut(this,this,t),this.onChange(),this}dot(t){return ve(this,t)}fromMatrix3(t){return we(this,t),this.onChange(),this}fromEuler(t){return Me(this,t,t.order),this}fromAxisAngle(t,i){return ue(this,t,i),this}slerp(t,i){return me(this,this,t,i),this}fromArray(t,i=0){return this[0]=t[i],this[1]=t[i+1],this[2]=t[i+2],this[3]=t[i+3],this}toArray(t=[],i=0){return t[i]=this[0],t[i+1]=this[1],t[i+2]=this[2],t[i+3]=this[3],t}}const Se=1e-6;function _e(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Te(e,t,i,s,r,n,h,a,l,c,o,d,u,f,p,m,g){return e[0]=t,e[1]=i,e[2]=s,e[3]=r,e[4]=n,e[5]=h,e[6]=a,e[7]=l,e[8]=c,e[9]=o,e[10]=d,e[11]=u,e[12]=f,e[13]=p,e[14]=m,e[15]=g,e}function Fe(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Le(e,t){let i=t[0],s=t[1],r=t[2],n=t[3],h=t[4],a=t[5],l=t[6],c=t[7],o=t[8],d=t[9],u=t[10],f=t[11],p=t[12],m=t[13],g=t[14],x=t[15],v=i*a-s*h,E=i*l-r*h,w=i*c-n*h,y=s*l-r*a,M=s*c-n*a,T=r*c-n*l,R=o*m-d*p,F=o*g-u*p,S=o*x-f*p,L=d*g-u*m,z=d*x-f*m,_=u*x-f*g,b=v*_-E*z+w*L+y*S-M*F+T*R;return b?(b=1/b,e[0]=(a*_-l*z+c*L)*b,e[1]=(r*z-s*_-n*L)*b,e[2]=(m*T-g*M+x*y)*b,e[3]=(u*M-d*T-f*y)*b,e[4]=(l*S-h*_-c*F)*b,e[5]=(i*_-r*S+n*F)*b,e[6]=(g*w-p*T-x*E)*b,e[7]=(o*T-u*w+f*E)*b,e[8]=(h*z-a*S+c*R)*b,e[9]=(s*S-i*z-n*R)*b,e[10]=(p*M-m*w+x*v)*b,e[11]=(d*w-o*M-f*v)*b,e[12]=(a*F-h*L-l*R)*b,e[13]=(i*L-s*F+r*R)*b,e[14]=(m*E-p*y-g*v)*b,e[15]=(o*y-d*E+u*v)*b,e):null}function Re(e){let t=e[0],i=e[1],s=e[2],r=e[3],n=e[4],h=e[5],a=e[6],l=e[7],c=e[8],o=e[9],d=e[10],u=e[11],f=e[12],p=e[13],m=e[14],g=e[15],x=t*h-i*n,v=t*a-s*n,E=t*l-r*n,w=i*a-s*h,y=i*l-r*h,M=s*l-r*a,T=c*p-o*f,R=c*m-d*f,F=c*g-u*f,S=o*m-d*p,L=o*g-u*p,z=d*g-u*m;return x*z-v*L+E*S+w*F-y*R+M*T}function ft(e,t,i){let s=t[0],r=t[1],n=t[2],h=t[3],a=t[4],l=t[5],c=t[6],o=t[7],d=t[8],u=t[9],f=t[10],p=t[11],m=t[12],g=t[13],x=t[14],v=t[15],E=i[0],w=i[1],y=i[2],M=i[3];return e[0]=E*s+w*a+y*d+M*m,e[1]=E*r+w*l+y*u+M*g,e[2]=E*n+w*c+y*f+M*x,e[3]=E*h+w*o+y*p+M*v,E=i[4],w=i[5],y=i[6],M=i[7],e[4]=E*s+w*a+y*d+M*m,e[5]=E*r+w*l+y*u+M*g,e[6]=E*n+w*c+y*f+M*x,e[7]=E*h+w*o+y*p+M*v,E=i[8],w=i[9],y=i[10],M=i[11],e[8]=E*s+w*a+y*d+M*m,e[9]=E*r+w*l+y*u+M*g,e[10]=E*n+w*c+y*f+M*x,e[11]=E*h+w*o+y*p+M*v,E=i[12],w=i[13],y=i[14],M=i[15],e[12]=E*s+w*a+y*d+M*m,e[13]=E*r+w*l+y*u+M*g,e[14]=E*n+w*c+y*f+M*x,e[15]=E*h+w*o+y*p+M*v,e}function Ie(e,t,i){let s=i[0],r=i[1],n=i[2],h,a,l,c,o,d,u,f,p,m,g,x;return t===e?(e[12]=t[0]*s+t[4]*r+t[8]*n+t[12],e[13]=t[1]*s+t[5]*r+t[9]*n+t[13],e[14]=t[2]*s+t[6]*r+t[10]*n+t[14],e[15]=t[3]*s+t[7]*r+t[11]*n+t[15]):(h=t[0],a=t[1],l=t[2],c=t[3],o=t[4],d=t[5],u=t[6],f=t[7],p=t[8],m=t[9],g=t[10],x=t[11],e[0]=h,e[1]=a,e[2]=l,e[3]=c,e[4]=o,e[5]=d,e[6]=u,e[7]=f,e[8]=p,e[9]=m,e[10]=g,e[11]=x,e[12]=h*s+o*r+p*n+t[12],e[13]=a*s+d*r+m*n+t[13],e[14]=l*s+u*r+g*n+t[14],e[15]=c*s+f*r+x*n+t[15]),e}function Pe(e,t,i){let s=i[0],r=i[1],n=i[2];return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e[3]=t[3]*s,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Ce(e,t,i,s){let r=s[0],n=s[1],h=s[2],a=Math.hypot(r,n,h),l,c,o,d,u,f,p,m,g,x,v,E,w,y,M,T,R,F,S,L,z,_,b,O;return Math.abs(a)<Se?null:(a=1/a,r*=a,n*=a,h*=a,l=Math.sin(i),c=Math.cos(i),o=1-c,d=t[0],u=t[1],f=t[2],p=t[3],m=t[4],g=t[5],x=t[6],v=t[7],E=t[8],w=t[9],y=t[10],M=t[11],T=r*r*o+c,R=n*r*o+h*l,F=h*r*o-n*l,S=r*n*o-h*l,L=n*n*o+c,z=h*n*o+r*l,_=r*h*o+n*l,b=n*h*o-r*l,O=h*h*o+c,e[0]=d*T+m*R+E*F,e[1]=u*T+g*R+w*F,e[2]=f*T+x*R+y*F,e[3]=p*T+v*R+M*F,e[4]=d*S+m*L+E*z,e[5]=u*S+g*L+w*z,e[6]=f*S+x*L+y*z,e[7]=p*S+v*L+M*z,e[8]=d*_+m*b+E*O,e[9]=u*_+g*b+w*O,e[10]=f*_+x*b+y*O,e[11]=p*_+v*b+M*O,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function Oe(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Lt(e,t){let i=t[0],s=t[1],r=t[2],n=t[4],h=t[5],a=t[6],l=t[8],c=t[9],o=t[10];return e[0]=Math.hypot(i,s,r),e[1]=Math.hypot(n,h,a),e[2]=Math.hypot(l,c,o),e}function Ne(e){let t=e[0],i=e[1],s=e[2],r=e[4],n=e[5],h=e[6],a=e[8],l=e[9],c=e[10];const o=t*t+i*i+s*s,d=r*r+n*n+h*h,u=a*a+l*l+c*c;return Math.sqrt(Math.max(o,d,u))}const qe=function(){const e=[0,0,0];return function(t,i){let s=e;Lt(s,i);let r=1/s[0],n=1/s[1],h=1/s[2],a=i[0]*r,l=i[1]*n,c=i[2]*h,o=i[4]*r,d=i[5]*n,u=i[6]*h,f=i[8]*r,p=i[9]*n,m=i[10]*h,g=a+d+m,x=0;return g>0?(x=Math.sqrt(g+1)*2,t[3]=.25*x,t[0]=(u-p)/x,t[1]=(f-c)/x,t[2]=(l-o)/x):a>d&&a>m?(x=Math.sqrt(1+a-d-m)*2,t[3]=(u-p)/x,t[0]=.25*x,t[1]=(l+o)/x,t[2]=(f+c)/x):d>m?(x=Math.sqrt(1+d-a-m)*2,t[3]=(f-c)/x,t[0]=(l+o)/x,t[1]=.25*x,t[2]=(u+p)/x):(x=Math.sqrt(1+m-a-d)*2,t[3]=(l-o)/x,t[0]=(f+c)/x,t[1]=(u+p)/x,t[2]=.25*x),t}}();function Be(e,t,i,s){let r=t[0],n=t[1],h=t[2],a=t[3],l=r+r,c=n+n,o=h+h,d=r*l,u=r*c,f=r*o,p=n*c,m=n*o,g=h*o,x=a*l,v=a*c,E=a*o,w=s[0],y=s[1],M=s[2];return e[0]=(1-(p+g))*w,e[1]=(u+E)*w,e[2]=(f-v)*w,e[3]=0,e[4]=(u-E)*y,e[5]=(1-(d+g))*y,e[6]=(m+x)*y,e[7]=0,e[8]=(f+v)*M,e[9]=(m-x)*M,e[10]=(1-(d+p))*M,e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e}function De(e,t){let i=t[0],s=t[1],r=t[2],n=t[3],h=i+i,a=s+s,l=r+r,c=i*h,o=s*h,d=s*a,u=r*h,f=r*a,p=r*l,m=n*h,g=n*a,x=n*l;return e[0]=1-d-p,e[1]=o+x,e[2]=u-g,e[3]=0,e[4]=o-x,e[5]=1-c-p,e[6]=f+m,e[7]=0,e[8]=u+g,e[9]=f-m,e[10]=1-c-d,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ue(e,t,i,s,r){let n=1/Math.tan(t/2),h=1/(s-r);return e[0]=n/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(r+s)*h,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*r*s*h,e[15]=0,e}function ke(e,t,i,s,r,n,h){let a=1/(t-i),l=1/(s-r),c=1/(n-h);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+i)*a,e[13]=(r+s)*l,e[14]=(h+n)*c,e[15]=1,e}function Ve(e,t,i,s){let r=t[0],n=t[1],h=t[2],a=s[0],l=s[1],c=s[2],o=r-i[0],d=n-i[1],u=h-i[2],f=o*o+d*d+u*u;f===0?u=1:(f=1/Math.sqrt(f),o*=f,d*=f,u*=f);let p=l*u-c*d,m=c*o-a*u,g=a*d-l*o;return f=p*p+m*m+g*g,f===0&&(c?a+=1e-6:l?c+=1e-6:l+=1e-6,p=l*u-c*d,m=c*o-a*u,g=a*d-l*o,f=p*p+m*m+g*g),f=1/Math.sqrt(f),p*=f,m*=f,g*=f,e[0]=p,e[1]=m,e[2]=g,e[3]=0,e[4]=d*g-u*m,e[5]=u*p-o*g,e[6]=o*m-d*p,e[7]=0,e[8]=o,e[9]=d,e[10]=u,e[11]=0,e[12]=r,e[13]=n,e[14]=h,e[15]=1,e}class P extends Array{constructor(t=1,i=0,s=0,r=0,n=0,h=1,a=0,l=0,c=0,o=0,d=1,u=0,f=0,p=0,m=0,g=1){return super(t,i,s,r,n,h,a,l,c,o,d,u,f,p,m,g),this}get x(){return this[12]}get y(){return this[13]}get z(){return this[14]}get w(){return this[15]}set x(t){this[12]=t}set y(t){this[13]=t}set z(t){this[14]=t}set w(t){this[15]=t}set(t,i,s,r,n,h,a,l,c,o,d,u,f,p,m,g){return t.length?this.copy(t):(Te(this,t,i,s,r,n,h,a,l,c,o,d,u,f,p,m,g),this)}translate(t,i=this){return Ie(this,i,t),this}rotate(t,i,s=this){return Ce(this,s,t,i),this}scale(t,i=this){return Pe(this,i,typeof t=="number"?[t,t,t]:t),this}multiply(t,i){return i?ft(this,t,i):ft(this,this,t),this}identity(){return Fe(this),this}copy(t){return _e(this,t),this}fromPerspective({fov:t,aspect:i,near:s,far:r}={}){return Ue(this,t,i,s,r),this}fromOrthogonal({left:t,right:i,bottom:s,top:r,near:n,far:h}){return ke(this,t,i,s,r,n,h),this}fromQuaternion(t){return De(this,t),this}setPosition(t){return this.x=t[0],this.y=t[1],this.z=t[2],this}inverse(t=this){return Le(this,t),this}compose(t,i,s){return Be(this,t,i,s),this}getRotation(t){return qe(t,this),this}getTranslation(t){return Oe(t,this),this}getScaling(t){return Lt(t,this),this}getMaxScaleOnAxis(){return Ne(this)}lookAt(t,i,s){return Ve(this,t,i,s),this}determinant(){return Re(this)}fromArray(t,i=0){return this[0]=t[i],this[1]=t[i+1],this[2]=t[i+2],this[3]=t[i+3],this[4]=t[i+4],this[5]=t[i+5],this[6]=t[i+6],this[7]=t[i+7],this[8]=t[i+8],this[9]=t[i+9],this[10]=t[i+10],this[11]=t[i+11],this[12]=t[i+12],this[13]=t[i+13],this[14]=t[i+14],this[15]=t[i+15],this}toArray(t=[],i=0){return t[i]=this[0],t[i+1]=this[1],t[i+2]=this[2],t[i+3]=this[3],t[i+4]=this[4],t[i+5]=this[5],t[i+6]=this[6],t[i+7]=this[7],t[i+8]=this[8],t[i+9]=this[9],t[i+10]=this[10],t[i+11]=this[11],t[i+12]=this[12],t[i+13]=this[13],t[i+14]=this[14],t[i+15]=this[15],t}}function $e(e,t,i="YXZ"){return i==="XYZ"?(e[1]=Math.asin(Math.min(Math.max(t[8],-1),1)),Math.abs(t[8])<.99999?(e[0]=Math.atan2(-t[9],t[10]),e[2]=Math.atan2(-t[4],t[0])):(e[0]=Math.atan2(t[6],t[5]),e[2]=0)):i==="YXZ"?(e[0]=Math.asin(-Math.min(Math.max(t[9],-1),1)),Math.abs(t[9])<.99999?(e[1]=Math.atan2(t[8],t[10]),e[2]=Math.atan2(t[1],t[5])):(e[1]=Math.atan2(-t[2],t[0]),e[2]=0)):i==="ZXY"?(e[0]=Math.asin(Math.min(Math.max(t[6],-1),1)),Math.abs(t[6])<.99999?(e[1]=Math.atan2(-t[2],t[10]),e[2]=Math.atan2(-t[4],t[5])):(e[1]=0,e[2]=Math.atan2(t[1],t[0]))):i==="ZYX"?(e[1]=Math.asin(-Math.min(Math.max(t[2],-1),1)),Math.abs(t[2])<.99999?(e[0]=Math.atan2(t[6],t[10]),e[2]=Math.atan2(t[1],t[0])):(e[0]=0,e[2]=Math.atan2(-t[4],t[5]))):i==="YZX"?(e[2]=Math.asin(Math.min(Math.max(t[1],-1),1)),Math.abs(t[1])<.99999?(e[0]=Math.atan2(-t[9],t[5]),e[1]=Math.atan2(-t[2],t[0])):(e[0]=0,e[1]=Math.atan2(t[8],t[10]))):i==="XZY"&&(e[2]=Math.asin(-Math.min(Math.max(t[4],-1),1)),Math.abs(t[4])<.99999?(e[0]=Math.atan2(t[6],t[5]),e[1]=Math.atan2(t[8],t[0])):(e[0]=Math.atan2(-t[9],t[10]),e[1]=0)),e}const pt=new P;class Xe extends Array{constructor(t=0,i=t,s=t,r="YXZ"){return super(t,i,s),this.order=r,this.onChange=()=>{},this}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(t){this[0]=t,this.onChange()}set y(t){this[1]=t,this.onChange()}set z(t){this[2]=t,this.onChange()}set(t,i=t,s=t){return t.length?this.copy(t):(this[0]=t,this[1]=i,this[2]=s,this.onChange(),this)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.onChange(),this}reorder(t){return this.order=t,this.onChange(),this}fromRotationMatrix(t,i=this.order){return $e(this,t,i),this}fromQuaternion(t,i=this.order){return pt.fromQuaternion(t),this.fromRotationMatrix(pt,i)}toArray(t=[],i=0){return t[i]=this[0],t[i+1]=this[1],t[i+2]=this[2],t}}class H{constructor(){this.parent=null,this.children=[],this.visible=!0,this.matrix=new P,this.worldMatrix=new P,this.matrixAutoUpdate=!0,this.position=new A,this.quaternion=new ze,this.scale=new A(1),this.rotation=new Xe,this.up=new A(0,1,0),this.rotation.onChange=()=>this.quaternion.fromEuler(this.rotation),this.quaternion.onChange=()=>this.rotation.fromQuaternion(this.quaternion)}setParent(t,i=!0){this.parent&&t!==this.parent&&this.parent.removeChild(this,!1),this.parent=t,i&&t&&t.addChild(this,!1)}addChild(t,i=!0){~this.children.indexOf(t)||this.children.push(t),i&&t.setParent(this,!1)}removeChild(t,i=!0){~this.children.indexOf(t)&&this.children.splice(this.children.indexOf(t),1),i&&t.setParent(null,!1)}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.worldMatrixNeedsUpdate||t)&&(this.parent===null?this.worldMatrix.copy(this.matrix):this.worldMatrix.multiply(this.parent.worldMatrix,this.matrix),this.worldMatrixNeedsUpdate=!1,t=!0);for(let i=0,s=this.children.length;i<s;i++)this.children[i].updateMatrixWorld(t)}updateMatrix(){this.matrix.compose(this.quaternion,this.position,this.scale),this.worldMatrixNeedsUpdate=!0}traverse(t){if(!t(this))for(let i=0,s=this.children.length;i<s;i++)this.children[i].traverse(t)}decompose(){this.matrix.getTranslation(this.position),this.matrix.getRotation(this.quaternion),this.matrix.getScaling(this.scale),this.rotation.fromQuaternion(this.quaternion)}lookAt(t,i=!1){i?this.matrix.lookAt(this.position,t,this.up):this.matrix.lookAt(t,this.position,this.up),this.matrix.getRotation(this.quaternion),this.rotation.fromQuaternion(this.quaternion)}}const Ye=new P,Ge=new A,je=new A;class We extends H{constructor(t,{near:i=.1,far:s=100,fov:r=45,aspect:n=1,left:h,right:a,bottom:l,top:c,zoom:o=1}={}){super(),Object.assign(this,{near:i,far:s,fov:r,aspect:n,left:h,right:a,bottom:l,top:c,zoom:o}),this.projectionMatrix=new P,this.viewMatrix=new P,this.projectionViewMatrix=new P,this.worldPosition=new A,this.type=h||a?"orthographic":"perspective",this.type==="orthographic"?this.orthographic():this.perspective()}perspective({near:t=this.near,far:i=this.far,fov:s=this.fov,aspect:r=this.aspect}={}){return Object.assign(this,{near:t,far:i,fov:s,aspect:r}),this.projectionMatrix.fromPerspective({fov:s*(Math.PI/180),aspect:r,near:t,far:i}),this.type="perspective",this}orthographic({near:t=this.near,far:i=this.far,left:s=this.left,right:r=this.right,bottom:n=this.bottom,top:h=this.top,zoom:a=this.zoom}={}){return Object.assign(this,{near:t,far:i,left:s,right:r,bottom:n,top:h,zoom:a}),s/=a,r/=a,n/=a,h/=a,this.projectionMatrix.fromOrthogonal({left:s,right:r,bottom:n,top:h,near:t,far:i}),this.type="orthographic",this}updateMatrixWorld(){return super.updateMatrixWorld(),this.viewMatrix.inverse(this.worldMatrix),this.worldMatrix.getTranslation(this.worldPosition),this.projectionViewMatrix.multiply(this.projectionMatrix,this.viewMatrix),this}lookAt(t){return super.lookAt(t,!0),this}project(t){return t.applyMatrix4(this.viewMatrix),t.applyMatrix4(this.projectionMatrix),this}unproject(t){return t.applyMatrix4(Ye.inverse(this.projectionMatrix)),t.applyMatrix4(this.worldMatrix),this}updateFrustum(){this.frustum||(this.frustum=[new A,new A,new A,new A,new A,new A]);const t=this.projectionViewMatrix;this.frustum[0].set(t[3]-t[0],t[7]-t[4],t[11]-t[8]).constant=t[15]-t[12],this.frustum[1].set(t[3]+t[0],t[7]+t[4],t[11]+t[8]).constant=t[15]+t[12],this.frustum[2].set(t[3]+t[1],t[7]+t[5],t[11]+t[9]).constant=t[15]+t[13],this.frustum[3].set(t[3]-t[1],t[7]-t[5],t[11]-t[9]).constant=t[15]-t[13],this.frustum[4].set(t[3]-t[2],t[7]-t[6],t[11]-t[10]).constant=t[15]-t[14],this.frustum[5].set(t[3]+t[2],t[7]+t[6],t[11]+t[10]).constant=t[15]+t[14];for(let i=0;i<6;i++){const s=1/this.frustum[i].distance();this.frustum[i].multiply(s),this.frustum[i].constant*=s}}frustumIntersectsMesh(t,i=t.worldMatrix){if(!t.geometry.attributes.position||((!t.geometry.bounds||t.geometry.bounds.radius===1/0)&&t.geometry.computeBoundingSphere(),!t.geometry.bounds))return!0;const s=Ge;s.copy(t.geometry.bounds.center),s.applyMatrix4(i);const r=t.geometry.bounds.radius*i.getMaxScaleOnAxis();return this.frustumIntersectsSphere(s,r)}frustumIntersectsSphere(t,i){const s=je;for(let r=0;r<6;r++){const n=this.frustum[r];if(s.copy(n).dot(t)+n.constant<-i)return!1}return!0}}function Ze(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function He(e,t){let i=t[0],s=t[1],r=t[2],n=t[3],h=i+i,a=s+s,l=r+r,c=i*h,o=s*h,d=s*a,u=r*h,f=r*a,p=r*l,m=n*h,g=n*a,x=n*l;return e[0]=1-d-p,e[3]=o-x,e[6]=u+g,e[1]=o+x,e[4]=1-c-p,e[7]=f-m,e[2]=u-g,e[5]=f+m,e[8]=1-c-d,e}function Qe(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Ke(e,t,i,s,r,n,h,a,l,c){return e[0]=t,e[1]=i,e[2]=s,e[3]=r,e[4]=n,e[5]=h,e[6]=a,e[7]=l,e[8]=c,e}function Je(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function ti(e,t){let i=t[0],s=t[1],r=t[2],n=t[3],h=t[4],a=t[5],l=t[6],c=t[7],o=t[8],d=o*h-a*c,u=-o*n+a*l,f=c*n-h*l,p=i*d+s*u+r*f;return p?(p=1/p,e[0]=d*p,e[1]=(-o*s+r*c)*p,e[2]=(a*s-r*h)*p,e[3]=u*p,e[4]=(o*i-r*l)*p,e[5]=(-a*i+r*n)*p,e[6]=f*p,e[7]=(-c*i+s*l)*p,e[8]=(h*i-s*n)*p,e):null}function gt(e,t,i){let s=t[0],r=t[1],n=t[2],h=t[3],a=t[4],l=t[5],c=t[6],o=t[7],d=t[8],u=i[0],f=i[1],p=i[2],m=i[3],g=i[4],x=i[5],v=i[6],E=i[7],w=i[8];return e[0]=u*s+f*h+p*c,e[1]=u*r+f*a+p*o,e[2]=u*n+f*l+p*d,e[3]=m*s+g*h+x*c,e[4]=m*r+g*a+x*o,e[5]=m*n+g*l+x*d,e[6]=v*s+E*h+w*c,e[7]=v*r+E*a+w*o,e[8]=v*n+E*l+w*d,e}function ei(e,t,i){let s=t[0],r=t[1],n=t[2],h=t[3],a=t[4],l=t[5],c=t[6],o=t[7],d=t[8],u=i[0],f=i[1];return e[0]=s,e[1]=r,e[2]=n,e[3]=h,e[4]=a,e[5]=l,e[6]=u*s+f*h+c,e[7]=u*r+f*a+o,e[8]=u*n+f*l+d,e}function ii(e,t,i){let s=t[0],r=t[1],n=t[2],h=t[3],a=t[4],l=t[5],c=t[6],o=t[7],d=t[8],u=Math.sin(i),f=Math.cos(i);return e[0]=f*s+u*h,e[1]=f*r+u*a,e[2]=f*n+u*l,e[3]=f*h-u*s,e[4]=f*a-u*r,e[5]=f*l-u*n,e[6]=c,e[7]=o,e[8]=d,e}function si(e,t,i){let s=i[0],r=i[1];return e[0]=s*t[0],e[1]=s*t[1],e[2]=s*t[2],e[3]=r*t[3],e[4]=r*t[4],e[5]=r*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function ri(e,t){let i=t[0],s=t[1],r=t[2],n=t[3],h=t[4],a=t[5],l=t[6],c=t[7],o=t[8],d=t[9],u=t[10],f=t[11],p=t[12],m=t[13],g=t[14],x=t[15],v=i*a-s*h,E=i*l-r*h,w=i*c-n*h,y=s*l-r*a,M=s*c-n*a,T=r*c-n*l,R=o*m-d*p,F=o*g-u*p,S=o*x-f*p,L=d*g-u*m,z=d*x-f*m,_=u*x-f*g,b=v*_-E*z+w*L+y*S-M*F+T*R;return b?(b=1/b,e[0]=(a*_-l*z+c*L)*b,e[1]=(l*S-h*_-c*F)*b,e[2]=(h*z-a*S+c*R)*b,e[3]=(r*z-s*_-n*L)*b,e[4]=(i*_-r*S+n*F)*b,e[5]=(s*S-i*z-n*R)*b,e[6]=(m*T-g*M+x*y)*b,e[7]=(g*w-p*T-x*E)*b,e[8]=(p*M-m*w+x*v)*b,e):null}class ni extends Array{constructor(t=1,i=0,s=0,r=0,n=1,h=0,a=0,l=0,c=1){return super(t,i,s,r,n,h,a,l,c),this}set(t,i,s,r,n,h,a,l,c){return t.length?this.copy(t):(Ke(this,t,i,s,r,n,h,a,l,c),this)}translate(t,i=this){return ei(this,i,t),this}rotate(t,i=this){return ii(this,i,t),this}scale(t,i=this){return si(this,i,t),this}multiply(t,i){return i?gt(this,t,i):gt(this,this,t),this}identity(){return Je(this),this}copy(t){return Qe(this,t),this}fromMatrix4(t){return Ze(this,t),this}fromQuaternion(t){return He(this,t),this}fromBasis(t,i,s){return this.set(t[0],t[1],t[2],i[0],i[1],i[2],s[0],s[1],s[2]),this}inverse(t=this){return ti(this,t),this}getNormalMatrix(t){return ri(this,t),this}}let hi=0;class ai extends H{constructor(t,{geometry:i,program:s,mode:r=t.TRIANGLES,frustumCulled:n=!0,renderOrder:h=0}={}){super(),t.canvas||console.error("gl not passed as first argument to Mesh"),this.gl=t,this.id=hi++,this.geometry=i,this.program=s,this.mode=r,this.frustumCulled=n,this.renderOrder=h,this.modelViewMatrix=new P,this.normalMatrix=new ni,this.beforeRenderCallbacks=[],this.afterRenderCallbacks=[]}onBeforeRender(t){return this.beforeRenderCallbacks.push(t),this}onAfterRender(t){return this.afterRenderCallbacks.push(t),this}draw({camera:t}={}){this.beforeRenderCallbacks.forEach(s=>s&&s({mesh:this,camera:t})),t&&(this.program.uniforms.modelMatrix||Object.assign(this.program.uniforms,{modelMatrix:{value:null},viewMatrix:{value:null},modelViewMatrix:{value:null},normalMatrix:{value:null},projectionMatrix:{value:null},cameraPosition:{value:null}}),this.program.uniforms.projectionMatrix.value=t.projectionMatrix,this.program.uniforms.cameraPosition.value=t.worldPosition,this.program.uniforms.viewMatrix.value=t.viewMatrix,this.modelViewMatrix.multiply(t.viewMatrix,this.worldMatrix),this.normalMatrix.getNormalMatrix(this.modelViewMatrix),this.program.uniforms.modelMatrix.value=this.worldMatrix,this.program.uniforms.modelViewMatrix.value=this.modelViewMatrix,this.program.uniforms.normalMatrix.value=this.normalMatrix);let i=this.program.cullFace&&this.worldMatrix.determinant()<0;this.program.use({flipFaces:i}),this.geometry.draw({mode:this.mode,program:this.program}),this.afterRenderCallbacks.forEach(s=>s&&s({mesh:this,camera:t}))}}const mt=new Uint8Array(4);function xt(e){return(e&e-1)===0}let li=1;class ci{constructor(t,{image:i,target:s=t.TEXTURE_2D,type:r=t.UNSIGNED_BYTE,format:n=t.RGBA,internalFormat:h=n,wrapS:a=t.CLAMP_TO_EDGE,wrapT:l=t.CLAMP_TO_EDGE,generateMipmaps:c=!0,minFilter:o=c?t.NEAREST_MIPMAP_LINEAR:t.LINEAR,magFilter:d=t.LINEAR,premultiplyAlpha:u=!1,unpackAlignment:f=4,flipY:p=s==t.TEXTURE_2D,anisotropy:m=0,level:g=0,width:x,height:v=x}={}){this.gl=t,this.id=li++,this.image=i,this.target=s,this.type=r,this.format=n,this.internalFormat=h,this.minFilter=o,this.magFilter=d,this.wrapS=a,this.wrapT=l,this.generateMipmaps=c,this.premultiplyAlpha=u,this.unpackAlignment=f,this.flipY=p,this.anisotropy=Math.min(m,this.gl.renderer.parameters.maxAnisotropy),this.level=g,this.width=x,this.height=v,this.texture=this.gl.createTexture(),this.store={image:null},this.glState=this.gl.renderer.state,this.state={},this.state.minFilter=this.gl.NEAREST_MIPMAP_LINEAR,this.state.magFilter=this.gl.LINEAR,this.state.wrapS=this.gl.REPEAT,this.state.wrapT=this.gl.REPEAT,this.state.anisotropy=0}bind(){this.glState.textureUnits[this.glState.activeTextureUnit]!==this.id&&(this.gl.bindTexture(this.target,this.texture),this.glState.textureUnits[this.glState.activeTextureUnit]=this.id)}update(t=0){const i=!(this.image===this.store.image&&!this.needsUpdate);if((i||this.glState.textureUnits[t]!==this.id)&&(this.gl.renderer.activeTexture(t),this.bind()),!!i){if(this.needsUpdate=!1,this.flipY!==this.glState.flipY&&(this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,this.flipY),this.glState.flipY=this.flipY),this.premultiplyAlpha!==this.glState.premultiplyAlpha&&(this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),this.glState.premultiplyAlpha=this.premultiplyAlpha),this.unpackAlignment!==this.glState.unpackAlignment&&(this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,this.unpackAlignment),this.glState.unpackAlignment=this.unpackAlignment),this.minFilter!==this.state.minFilter&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_MIN_FILTER,this.minFilter),this.state.minFilter=this.minFilter),this.magFilter!==this.state.magFilter&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_MAG_FILTER,this.magFilter),this.state.magFilter=this.magFilter),this.wrapS!==this.state.wrapS&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_S,this.wrapS),this.state.wrapS=this.wrapS),this.wrapT!==this.state.wrapT&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_T,this.wrapT),this.state.wrapT=this.wrapT),this.anisotropy&&this.anisotropy!==this.state.anisotropy&&(this.gl.texParameterf(this.target,this.gl.renderer.getExtension("EXT_texture_filter_anisotropic").TEXTURE_MAX_ANISOTROPY_EXT,this.anisotropy),this.state.anisotropy=this.anisotropy),this.image){if(this.image.width&&(this.width=this.image.width,this.height=this.image.height),this.target===this.gl.TEXTURE_CUBE_MAP)for(let s=0;s<6;s++)this.gl.texImage2D(this.gl.TEXTURE_CUBE_MAP_POSITIVE_X+s,this.level,this.internalFormat,this.format,this.type,this.image[s]);else if(ArrayBuffer.isView(this.image))this.gl.texImage2D(this.target,this.level,this.internalFormat,this.width,this.height,0,this.format,this.type,this.image);else if(this.image.isCompressedTexture)for(let s=0;s<this.image.length;s++)this.gl.compressedTexImage2D(this.target,s,this.internalFormat,this.image[s].width,this.image[s].height,0,this.image[s].data);else this.gl.texImage2D(this.target,this.level,this.internalFormat,this.format,this.type,this.image);this.generateMipmaps&&(!this.gl.renderer.isWebgl2&&(!xt(this.image.width)||!xt(this.image.height))?(this.generateMipmaps=!1,this.wrapS=this.wrapT=this.gl.CLAMP_TO_EDGE,this.minFilter=this.gl.LINEAR):this.gl.generateMipmap(this.target)),this.onUpdate&&this.onUpdate()}else if(this.target===this.gl.TEXTURE_CUBE_MAP)for(let s=0;s<6;s++)this.gl.texImage2D(this.gl.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,this.gl.RGBA,1,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,mt);else this.width?this.gl.texImage2D(this.target,this.level,this.internalFormat,this.width,this.height,0,this.format,this.type,null):this.gl.texImage2D(this.target,0,this.gl.RGBA,1,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,mt);this.store.image=this.image}}}function oi(e,t){return e[0]=t[0],e[1]=t[1],e}function di(e,t,i){return e[0]=t,e[1]=i,e}function yt(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e}function wt(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e}function ui(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e}function fi(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e}function Y(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e}function pi(e,t){var i=t[0]-e[0],s=t[1]-e[1];return Math.sqrt(i*i+s*s)}function gi(e,t){var i=t[0]-e[0],s=t[1]-e[1];return i*i+s*s}function Mt(e){var t=e[0],i=e[1];return Math.sqrt(t*t+i*i)}function mi(e){var t=e[0],i=e[1];return t*t+i*i}function xi(e,t){return e[0]=-t[0],e[1]=-t[1],e}function yi(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function wi(e,t){var i=t[0],s=t[1],r=i*i+s*s;return r>0&&(r=1/Math.sqrt(r)),e[0]=t[0]*r,e[1]=t[1]*r,e}function Mi(e,t){return e[0]*t[0]+e[1]*t[1]}function bt(e,t){return e[0]*t[1]-e[1]*t[0]}function bi(e,t,i,s){var r=t[0],n=t[1];return e[0]=r+s*(i[0]-r),e[1]=n+s*(i[1]-n),e}function Ei(e,t,i){var s=t[0],r=t[1];return e[0]=i[0]*s+i[3]*r+i[6],e[1]=i[1]*s+i[4]*r+i[7],e}function vi(e,t,i){let s=t[0],r=t[1];return e[0]=i[0]*s+i[4]*r+i[12],e[1]=i[1]*s+i[5]*r+i[13],e}function Ai(e,t){return e[0]===t[0]&&e[1]===t[1]}class N extends Array{constructor(t=0,i=t){return super(t,i),this}get x(){return this[0]}get y(){return this[1]}set x(t){this[0]=t}set y(t){this[1]=t}set(t,i=t){return t.length?this.copy(t):(di(this,t,i),this)}copy(t){return oi(this,t),this}add(t,i){return i?yt(this,t,i):yt(this,this,t),this}sub(t,i){return i?wt(this,t,i):wt(this,this,t),this}multiply(t){return t.length?ui(this,this,t):Y(this,this,t),this}divide(t){return t.length?fi(this,this,t):Y(this,this,1/t),this}inverse(t=this){return yi(this,t),this}len(){return Mt(this)}distance(t){return t?pi(this,t):Mt(this)}squaredLen(){return this.squaredDistance()}squaredDistance(t){return t?gi(this,t):mi(this)}negate(t=this){return xi(this,t),this}cross(t,i){return i?bt(t,i):bt(this,t)}scale(t){return Y(this,this,t),this}normalize(){return wi(this,this),this}dot(t){return Mi(this,t)}equals(t){return Ai(this,t)}applyMatrix3(t){return Ei(this,this,t),this}applyMatrix4(t){return vi(this,this,t),this}lerp(t,i){return bi(this,this,t,i),this}clone(){return new N(this[0],this[1])}fromArray(t,i=0){return this[0]=t[i],this[1]=t[i+1],this}toArray(t=[],i=0){return t[i]=this[0],t[i+1]=this[1],t}}class Q extends Jt{constructor(t,{width:i=1,height:s=1,widthSegments:r=1,heightSegments:n=1,attributes:h={}}={}){const a=r,l=n,c=(a+1)*(l+1),o=a*l*6,d=new Float32Array(c*3),u=new Float32Array(c*3),f=new Float32Array(c*2),p=o>65536?new Uint32Array(o):new Uint16Array(o);Q.buildPlane(d,u,f,p,i,s,0,a,l),Object.assign(h,{position:{size:3,data:d},normal:{size:3,data:u},uv:{size:2,data:f},index:{data:p}}),super(t,h)}static buildPlane(t,i,s,r,n,h,a,l,c,o=0,d=1,u=2,f=1,p=-1,m=0,g=0){const x=m,v=n/l,E=h/c;for(let w=0;w<=c;w++){let y=w*E-h/2;for(let M=0;M<=l;M++,m++){let T=M*v-n/2;if(t[m*3+o]=T*f,t[m*3+d]=y*p,t[m*3+u]=a/2,i[m*3+o]=0,i[m*3+d]=0,i[m*3+u]=a>=0?1:-1,s[m*2]=M/l,s[m*2+1]=1-w/c,w===c||M===l)continue;let R=x+M+w*(l+1),F=x+M+(w+1)*(l+1),S=x+M+(w+1)*(l+1)+1,L=x+M+w*(l+1)+1;r[g*6]=R,r[g*6+1]=F,r[g*6+2]=L,r[g*6+3]=F,r[g*6+4]=S,r[g*6+5]=L,g++}}}}const zi=new N,Si=new N,_i=new N,Et=new A,vt=new A,At=new A,Ti=new A,Fi=new A,Li=new A,zt=new A,G=new A,St=new A,_t=new A,Ri=new A,Tt=new P;class Ii{constructor(){this.origin=new A,this.direction=new A}castMouse(t,i=[0,0]){if(t.type==="orthographic"){const{left:s,right:r,bottom:n,top:h,zoom:a}=t,l=s/a+(r-s)/a*(i[0]*.5+.5),c=n/a+(h-n)/a*(i[1]*.5+.5);this.origin.set(l,c,0),this.origin.applyMatrix4(t.worldMatrix),this.direction.x=-t.worldMatrix[8],this.direction.y=-t.worldMatrix[9],this.direction.z=-t.worldMatrix[10]}else t.worldMatrix.getTranslation(this.origin),this.direction.set(i[0],i[1],.5),t.unproject(this.direction),this.direction.sub(this.origin).normalize()}intersectBounds(t,{maxDistance:i,output:s=[]}={}){Array.isArray(t)||(t=[t]);const r=Tt,n=Et,h=vt,a=s;return a.length=0,t.forEach(l=>{(!l.geometry.bounds||l.geometry.bounds.radius===1/0)&&l.geometry.computeBoundingSphere();const c=l.geometry.bounds;r.inverse(l.worldMatrix);let o;if(i&&(h.copy(this.direction).scaleRotateMatrix4(r),o=i*h.len()),n.copy(this.origin).applyMatrix4(r),h.copy(this.direction).transformDirection(r),i&&n.distance(c.center)-c.radius>o)return;let d=0;if(l.geometry.raycast==="sphere"){if(n.distance(c.center)>c.radius&&(d=this.intersectSphere(c,n,h),!d))return}else if((n.x<c.min.x||n.x>c.max.x||n.y<c.min.y||n.y>c.max.y||n.z<c.min.z||n.z>c.max.z)&&(d=this.intersectBox(c,n,h),!d))return;i&&d>o||(l.hit||(l.hit={localPoint:new A,point:new A}),l.hit.localPoint.copy(h).multiply(d).add(n),l.hit.point.copy(l.hit.localPoint).applyMatrix4(l.worldMatrix),l.hit.distance=l.hit.point.distance(this.origin),a.push(l))}),a.sort((l,c)=>l.hit.distance-c.hit.distance),a}intersectMeshes(t,{cullFace:i=!0,maxDistance:s,includeUV:r=!0,includeNormal:n=!0,output:h=[]}={}){const a=this.intersectBounds(t,{maxDistance:s,output:h});if(!a.length)return a;const l=Tt,c=Et,o=vt,d=At,u=Ti,f=Fi,p=Li,m=zt,g=G,x=zi,v=Si,E=_i;for(let w=a.length-1;w>=0;w--){const y=a[w];l.inverse(y.worldMatrix);let M;s&&(o.copy(this.direction).scaleRotateMatrix4(l),M=s*o.len()),c.copy(this.origin).applyMatrix4(l),o.copy(this.direction).transformDirection(l);let T=0,R,F,S;const L=y.geometry,z=L.attributes,_=z.index,b=z.position,O=Math.max(0,L.drawRange.start),Rt=Math.min(_?_.count:b.count,L.drawRange.start+L.drawRange.count),U=b.stride?b.stride/b.data.BYTES_PER_ELEMENT:b.size;for(let C=O;C<Rt;C+=3){const K=_?_.data[C]:C,J=_?_.data[C+1]:C+1,tt=_?_.data[C+2]:C+2;d.fromArray(b.data,K*U),u.fromArray(b.data,J*U),f.fromArray(b.data,tt*U);const B=this.intersectTriangle(d,u,f,i,c,o,m);!B||s&&B>M||(!T||B<T)&&(T=B,R=K,F=J,S=tt,p.copy(m))}T||a.splice(w,1),y.hit.localPoint.copy(o).multiply(T).add(c),y.hit.point.copy(y.hit.localPoint).applyMatrix4(y.worldMatrix),y.hit.distance=y.hit.point.distance(this.origin),y.hit.faceNormal||(y.hit.localFaceNormal=new A,y.hit.faceNormal=new A,y.hit.uv=new N,y.hit.localNormal=new A,y.hit.normal=new A),y.hit.localFaceNormal.copy(p),y.hit.faceNormal.copy(y.hit.localFaceNormal).transformDirection(y.worldMatrix),(r||n)&&(d.fromArray(b.data,R*3),u.fromArray(b.data,F*3),f.fromArray(b.data,S*3),this.getBarycoord(y.hit.localPoint,d,u,f,g)),r&&z.uv&&(x.fromArray(z.uv.data,R*2),v.fromArray(z.uv.data,F*2),E.fromArray(z.uv.data,S*2),y.hit.uv.set(x.x*g.x+v.x*g.y+E.x*g.z,x.y*g.x+v.y*g.y+E.y*g.z)),n&&z.normal&&(d.fromArray(z.normal.data,R*3),u.fromArray(z.normal.data,F*3),f.fromArray(z.normal.data,S*3),y.hit.localNormal.set(d.x*g.x+u.x*g.y+f.x*g.z,d.y*g.x+u.y*g.y+f.y*g.z,d.z*g.x+u.z*g.y+f.z*g.z),y.hit.normal.copy(y.hit.localNormal).transformDirection(y.worldMatrix))}return a.sort((w,y)=>w.hit.distance-y.hit.distance),a}intersectSphere(t,i=this.origin,s=this.direction){const r=At;r.sub(t.center,i);const n=r.dot(s),h=r.dot(r)-n*n,a=t.radius*t.radius;if(h>a)return 0;const l=Math.sqrt(a-h),c=n-l,o=n+l;return c<0&&o<0?0:c<0?o:c}intersectBox(t,i=this.origin,s=this.direction){let r,n,h,a,l,c;const o=1/s.x,d=1/s.y,u=1/s.z,f=t.min,p=t.max;return r=((o>=0?f.x:p.x)-i.x)*o,n=((o>=0?p.x:f.x)-i.x)*o,h=((d>=0?f.y:p.y)-i.y)*d,a=((d>=0?p.y:f.y)-i.y)*d,r>a||h>n||(h>r&&(r=h),a<n&&(n=a),l=((u>=0?f.z:p.z)-i.z)*u,c=((u>=0?p.z:f.z)-i.z)*u,r>c||l>n)||(l>r&&(r=l),c<n&&(n=c),n<0)?0:r>=0?r:n}intersectTriangle(t,i,s,r=!0,n=this.origin,h=this.direction,a=zt){const l=G,c=St,o=_t;l.sub(i,t),c.sub(s,t),a.cross(l,c);let d=h.dot(a);if(!d)return 0;let u;if(d>0){if(r)return 0;u=1}else u=-1,d=-d;o.sub(n,t);let f=u*h.dot(c.cross(o,c));if(f<0)return 0;let p=u*h.dot(l.cross(o));if(p<0||f+p>d)return 0;let m=-u*o.dot(a);return m<0?0:m/d}getBarycoord(t,i,s,r,n=G){const h=St,a=_t,l=Ri;h.sub(r,i),a.sub(s,i),l.sub(t,i);const c=h.dot(h),o=h.dot(a),d=h.dot(l),u=a.dot(a),f=a.dot(l),p=c*u-o*o;if(p===0)return n.set(-2,-1,-1);const m=1/p,g=(u*d-o*f)*m,x=(c*f-o*d)*m;return n.set(1-g-x,x,g)}}class Pi{constructor(){this.app=new I,this.sizes=this.app.sizes,this.init()}init(){this.instance=new We,this.instance.position.z=3,this.instance.fov=45}resize(){this.instance.perspective({aspect:this.sizes.width/this.sizes.height})}}class Ci{constructor(){this.app=new I,this.sizes=this.app.sizes,this.init()}init(){this.instance=new he({alpha:!0,antialis:!0,dpr:2}),this.gl=this.instance.gl,document.body.appendChild(this.gl.canvas)}resize(){this.instance.setSize(this.sizes.width,this.sizes.height)}update(){this.instance.render({scene:this.app.scene.instance,camera:this.app.camera.instance})}}class Oi extends Z{constructor(){super(),this.app=new I,this.gl=this.app.renderer.gl,this.articles=this.app.articles,this.loaded=0,this.toLoad=this.articles.length,this.cache={},this.loadAll()}loadAll(){this.articles.forEach(t=>{this.load(t.image,t)})}load(t,i){const s=new ci(this.gl,{generateMipmaps:!1}),r=new Image;r.src=t,r.onload=()=>{s.image=r,this.loaded++,i.texture=s,i.image=r,this.checkFinish()}}checkFinish(){this.loaded===this.toLoad&&this.trigger("loaded")}}var Ni=`precision highp float;

uniform vec2 uImageSizes;
uniform vec2 uPlaneSizes;
uniform float uOffset;
uniform sampler2D tMap;
uniform float uZoom;

varying vec2 vUv;
        
void main() {
    vec2 ratio = vec2(
        min((uPlaneSizes.x / uPlaneSizes.y) / (uImageSizes.x / uImageSizes.y), 1.0),
        min((uPlaneSizes.y / uPlaneSizes.x) / (uImageSizes.y / uImageSizes.x), 1.0)
    );
        
    vec2 uv = vec2(
        vUv.x * ratio.x + (1.0 - ratio.x) * 0.5 + uOffset,
        vUv.y * ratio.y + (1.0 - ratio.y) * 0.5
    );

    vec2 zoomedUv = vec2(
        mix(0.5, uv.x, uZoom),
        mix(0.5, uv.y, uZoom)
    );

    vec4 texture = texture2D(tMap, zoomedUv);

    gl_FragColor = texture;
}`,qi=`attribute vec3 position;

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat3 normalMatrix;

uniform float uVelocity;

attribute vec2 uv;

varying vec2 vUv;

void main() {
    vec3 pos = position;
    pos.x += uVelocity * uv.y * 0.0005;

    gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
    
    vUv = uv;
}`;function Bi(e,t,i){return Math.max(t,Math.min(e,i))}function D(e,t,i){return(1-i)*e+i*t}function Di(e,t,i,s,r,n=!1,h=!0,a=!0){if(h&&e<t)return s;if(a&&e>i)return r;const c=(e-t)/(i-t)*(r-s)+s;return n?Math.round(c):c}class Ui{constructor(t,i){this.app=new I,this.scene=this.app.scene.instance,this.gl=this.app.renderer.gl,this.scrolling=this.app.scrolling,this.camera=this.app.camera.instance,this.sizes=this.app.sizes,this.article=t,this.index=i,this.init(),this.setPositon()}init(){this.geometry=new Q(this.gl),this.texture=this.article.texture,this.image=this.article.image,this.program=new ee(this.gl,{vertex:qi,fragment:Ni,uniforms:{tMap:{value:this.texture},uImageSizes:{value:[this.image.naturalWidth,this.image.naturalHeight]},uPlaneSizes:{value:[0,0]},uOffset:{value:0},uZoom:{value:.85},uVelocity:{value:0}}}),this.mesh=new ai(this.gl,{geometry:this.geometry,program:this.program}),this.mesh.setParent(this.scene),this.mesh.scale.x=.83,this.mesh.scale.y=1.3,this.targetScaleX=this.mesh.scale.x,this.targetScaleY=this.mesh.scale.y}setPositon(){this.mesh.position.x=this.index*(this.mesh.scale.x+.1)}handleClick(){this.enlarge()}enlarge(){this.isEnlarged=!0,this.targetZoom=1,this.fov=this.camera.fov*(Math.PI/180),this.targetScaleY=2*Math.tan(this.fov/2)*this.camera.position.z,this.targetScaleX=this.targetScaleY*this.camera.aspect,this.mesh.position.z+=.001}resize(){this.isEnlarged===!0&&(this.targetScaleY=2*Math.tan(this.fov/2)*this.camera.position.z,this.targetScaleX=this.targetScaleY*this.camera.aspect)}update(){const t=this.mesh.position.x-this.scrolling.current/this.scrolling.ratio;this.program.uniforms.uOffset.value=Di(t,-4,4,-.35,.35),this.program.uniforms.uVelocity.value=this.scrolling.velocity,this.isEnlarged||(this.targetZoom=this.isHovered===!0?.95:.9),this.mesh.scale.x=D(this.mesh.scale.x,this.targetScaleX,.15),this.mesh.scale.y=D(this.mesh.scale.y,this.targetScaleY,.15),this.program.uniforms.uPlaneSizes.value=[this.mesh.scale.x,this.mesh.scale.y],this.program.uniforms.uZoom.value=D(this.program.uniforms.uZoom.value,this.targetZoom,.15)}}class ki{constructor(){this.app=new I,this.sizes=this.app.sizes,this.camera=this.app.camera.instance,this.gl=this.app.renderer.gl,this.mouse=new N,this.instance=new Ii(this.gl),this.meshes=[],this.app.scene.teaserImages.forEach(t=>{this.meshes.push(t.mesh)}),window.addEventListener("mousemove",this.handleMove.bind(this),!1),window.addEventListener("touchmove",this.handleMove.bind(this),!1),window.addEventListener("click",this.handleClick.bind(this),!1)}handleClick(){this.hitImage&&this.hitImage.handleClick()}handleMove(t){this.mouse.x=2*(t.x/this.sizes.width)-1,this.mouse.y=2*(1-t.y/this.sizes.height)-1,this.instance.castMouse(this.camera,this.mouse);const i=this.instance.intersectBounds(this.meshes);document.body.style.cursor=i.length?"pointer":"default",this.app.scene.teaserImages.forEach(s=>{s.isHovered=!1}),i.length?(this.hitImage=this.app.scene.teaserImages[this.meshes.indexOf(i[0])],this.hitImage.isHovered=!0):this.hitImage=null}}class Vi{constructor(){this.app=new I,this.loader=this.app.loader,this.articles=this.app.articles,this.instance=new H,this.teaserImages=[],this.loader.on("loaded",()=>{this.articles.forEach((t,i)=>{this.teaserImages.push(new Ui(t,i))}),this.raycasting=new ki})}resize(){this.teaserImages.forEach(t=>{t.resize()})}update(){this.teaserImages.forEach(t=>{t.update()})}}var $i=[{title:"Article 0",image:"/assets/example-0.webp",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed euismod, nisl vel ultricies lacinia, nisl nisl aliquam lorem, vitae aliquam nisl nunc vel mauris. Sed euismod, nisl vel ultricies lacinia, nisl nisl aliquam lorem, vitae aliquam nisl nunc vel mauris."},{title:"Article 1",image:"/assets/example-1.webp",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed euismod, nisl vel ultricies lacinia, nisl nisl aliquam lorem, vitae aliquam nisl nunc vel mauris. Sed euismod, nisl vel ultricies lacinia, nisl nisl aliquam lorem, vitae aliquam nisl nunc vel mauris."},{title:"Article 2",image:"/assets/example-2.webp",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed euismod, nisl vel ultricies lacinia, nisl nisl aliquam lorem, vitae aliquam nisl nunc vel mauris. Sed euismod, nisl vel ultricies lacinia, nisl nisl aliquam lorem, vitae aliquam nisl nunc vel mauris."},{title:"Article 3",image:"/assets/example-3.webp",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed euismod, nisl vel ultricies lacinia, nisl nisl aliquam lorem, vitae aliquam nisl nunc vel mauris. Sed euismod, nisl vel ultricies lacinia, nisl nisl aliquam lorem, vitae aliquam nisl nunc vel mauris."},{title:"Article 4",image:"/assets/example-4.webp",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed euismod, nisl vel ultricies lacinia, nisl nisl aliquam lorem, vitae aliquam nisl nunc vel mauris. Sed euismod, nisl vel ultricies lacinia, nisl nisl aliquam lorem, vitae aliquam nisl nunc vel mauris."},{title:"Article 5",image:"/assets/example-5.webp",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed euismod, nisl vel ultricies lacinia, nisl nisl aliquam lorem, vitae aliquam nisl nunc vel mauris. Sed euismod, nisl vel ultricies lacinia, nisl nisl aliquam lorem, vitae aliquam nisl nunc vel mauris."},{title:"Article 6",image:"/assets/example-6.webp",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed euismod, nisl vel ultricies lacinia, nisl nisl aliquam lorem, vitae aliquam nisl nunc vel mauris. Sed euismod, nisl vel ultricies lacinia, nisl nisl aliquam lorem, vitae aliquam nisl nunc vel mauris."},{title:"Article 7",image:"/assets/example-7.webp",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed euismod, nisl vel ultricies lacinia, nisl nisl aliquam lorem, vitae aliquam nisl nunc vel mauris. Sed euismod, nisl vel ultricies lacinia, nisl nisl aliquam lorem, vitae aliquam nisl nunc vel mauris."},{title:"Article 8",image:"/assets/example-8.webp",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed euismod, nisl vel ultricies lacinia, nisl nisl aliquam lorem, vitae aliquam nisl nunc vel mauris. Sed euismod, nisl vel ultricies lacinia, nisl nisl aliquam lorem, vitae aliquam nisl nunc vel mauris."}];class Xi{constructor(){this.app=new I,this.camera=this.app.camera.instance,this.trigger=window,this.speed=.5,this.current=0,this.target=0,this.easing=.08,this.limit=746,this.ratio=100,this.addEventListeners()}onWheel({deltaY:t}){this.target+=t*this.speed}onTouchStart(t){this.isDown=!0,this.x=t.touches?t.touches[0].clientX:t.clientX,this.position=this.current}onTouchMove(t){if(!this.isDown)return;const i=t.touches?t.touches[0].clientX:t.clientX,s=this.x-i;this.target=this.position+s*2}onTouchEnd(t){this.isDown=!1}addEventListeners(){this.trigger.addEventListener("wheel",this.onWheel.bind(this)),this.trigger.addEventListener("touchstart",this.onTouchStart.bind(this)),this.trigger.addEventListener("touchmove",this.onTouchMove.bind(this)),this.trigger.addEventListener("touchend",this.onTouchEnd.bind(this)),this.trigger.addEventListener("mousedown",this.onTouchStart.bind(this)),this.trigger.addEventListener("mousemove",this.onTouchMove.bind(this)),this.trigger.addEventListener("mouseup",this.onTouchEnd.bind(this)),window.oncontextmenu=this.onTouchEnd.bind(this)}update(){this.target=Bi(this.target,0,this.limit),this.current=D(this.current,this.target,this.easing),this.velocity=this.current-this.target,this.camera.position.x=this.current/this.ratio}}const q=class{constructor(t){if(q.instance)return q.instance;q.instance=this,this.options=t,this.canvas=this.options.canvas,this.articles=$i,this.time=new Ot,this.sizes=new Nt,this.camera=new Pi,this.renderer=new Ci,this.loader=new Oi,this.scene=new Vi,this.scrolling=new Xi,this.resize(),this.sizes.on("resize",()=>this.resize()),this.time.on("tick",()=>this.update())}resize(){this.camera.resize(),this.renderer.resize(),this.scene.resize()}update(){this.scene.update(),this.renderer.update(),this.scrolling.update()}};let I=q;et(I,"instance");const Yi=document.querySelector(".experience");new I({canvas:Yi});
